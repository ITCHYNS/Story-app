/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";const t={BASE_URL:"https://story-api.dicoding.dev/v1",MAP_SERVICE_API_KEY:"your_map_service_api_key_here",DEFAULT_MAP_CENTER:[-6.2088,106.8456],DEFAULT_MAP_ZOOM:10,VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",PUSH_NOTIFICATION_ENDPOINT:"/notifications/subscribe"};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(){r=function(){return n};var t,n={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),c=new A(n||[]);return a(i,"_invoke",{value:j(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}n.wrap=h;var d="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,s,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(N([])));L&&L!==o&&i.call(L,s)&&(k=L);var S=x.prototype=b.prototype=Object.create(k);function _(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,r){function n(o,a,c,s){var u=p(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==e(f)&&i.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,c,s)}),(function(t){n("throw",t,c,s)})):r.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(t,e){function i(){return new r((function(r,o){n(t,e,r,o)}))}return o=o?o.then(i,i):i()}})}function j(e,r,n){var o=d;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function N(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,a=function e(){for(;++o<r.length;)if(i.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(r)+" is not iterable")}return w.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},n.awrap=function(t){return{__await:t}},_(O.prototype),f(O.prototype,u,(function(){return this})),n.AsyncIterator=O,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var a=new O(h(t,e,r,o),i);return n.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),f(S,l,"Generator"),f(S,s,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},n.values=N,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},n}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function c(t){a(i,n,o,c,s,"next",t)}function s(t){a(i,n,o,c,s,"throw",t)}c(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}const l=new(function(){return e=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e},n=[{key:"_fetchWithAuth",value:(d=c(r().mark((function t(e){var n,i,a,c,s,u=arguments;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},i=localStorage.getItem("token"),a=o({"Content-Type":"application/json"},n.headers),i&&(a.Authorization="Bearer ".concat(i)),console.log("API Request:","".concat(this._baseUrl).concat(e),o({headers:a},n)),t.next=7,fetch("".concat(this._baseUrl).concat(e),o(o({},n),{},{headers:a}));case 7:return c=t.sent,t.next=10,c.json();case 10:if(s=t.sent,console.log("API Response:",c.status,s),c.ok){t.next=14;break}throw new Error(s.message||"HTTP ".concat(c.status,": Something went wrong"));case 14:return t.abrupt("return",s);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"register",value:(p=c(r().mark((function t(e){var n,o,i,a,c,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.name,a=e.email,c=e.password,t.next=3,this._fetchWithAuth("/register",{method:"POST",body:JSON.stringify({name:i,email:a,password:c})});case 3:return s=t.sent,t.abrupt("return",{data:{token:(null===(n=s.user)||void 0===n?void 0:n.token)||(null===(o=s.loginResult)||void 0===o?void 0:o.token),user:s.user||s.loginResult}});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"login",value:(h=c(r().mark((function t(e){var n,o,i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,o=e.password,t.next=3,this._fetchWithAuth("/login",{method:"POST",body:JSON.stringify({email:n,password:o})});case 3:return i=t.sent,t.abrupt("return",{data:{token:i.loginResult.token,user:i.loginResult}});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"getStories",value:(f=c(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._fetchWithAuth("/stories");case 2:return e=t.sent,t.abrupt("return",{listStories:e.listStory||e.stories||[]});case 4:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"getStoryDetail",value:(l=c(r().mark((function t(e){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._fetchWithAuth("/stories/".concat(e));case 2:return n=t.sent,t.abrupt("return",{story:n.story});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"subscribePush",value:(u=c(r().mark((function e(n){var o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=localStorage.getItem("token")){e.next=3;break}throw new Error("User not logged in");case 3:return e.abrupt("return",fetch("".concat(t.API_BASE_URL,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify(n.toJSON())}).then((function(t){return t.json()})));case 4:case"end":return e.stop()}}),e)}))),function(t){return u.apply(this,arguments)})},{key:"unsubscribePush",value:(a=c(r().mark((function e(n){var o,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=localStorage.getItem("token")){e.next=3;break}throw new Error("User not logged in");case 3:return i=n.endpoint,e.abrupt("return",fetch("".concat(t.API_BASE_URL,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({endpoint:i})}).then((function(t){return t.json()})));case 5:case"end":return e.stop()}}),e)}))),function(t){return a.apply(this,arguments)})},{key:"addStory",value:(i=c(r().mark((function t(e){var n,o,i,a,c,s,u,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.description,o=e.photo,i=e.lat,a=e.lon,(c=new FormData).append("description",n),c.append("photo",o),i&&c.append("lat",i),a&&c.append("lon",a),s=localStorage.getItem("token"),console.log("Add Story - Token:",s),t.next=10,fetch("".concat(this._baseUrl,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:c});case 10:return u=t.sent,t.next=13,u.json();case 13:if(l=t.sent,console.log("Add Story Response:",u.status,l),u.ok){t.next=17;break}throw new Error(l.message||"Failed to add story");case 17:return t.abrupt("return",l);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,i,a,u,l,f,h,p,d}())(t.BASE_URL);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t,e,r){return(e=function(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},r))}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="notification notification-".concat(e),r.textContent=t,r.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    padding: 12px 20px;\n    background: ".concat("error"===e?"#f44336":"success"===e?"#4CAF50":"#2196F3",";\n    color: white;\n    border-radius: 4px;\n    z-index: 10000;\n    animation: slideIn 0.3s ease;\n  "),document.body.appendChild(r),setTimeout((function(){r.style.animation="slideOut 0.3s ease",setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r)}),300)}),3e3)}function y(t){var e,r={};return null!==(e=t.description)&&void 0!==e&&e.trim()||(r.description="Description is required"),t.photo||(r.photo="Photo is required"),{isValid:0===Object.keys(r).length,errors:r}}let m,g;const b=new WeakMap,w=new WeakMap,x=new WeakMap,k=new WeakMap,E=new WeakMap;let S={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return w.get(t);if("objectStoreNames"===e)return t.objectStoreNames||x.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return O(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function _(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(g||(g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(j(this),t),O(b.get(this))}:function(...t){return O(e.apply(j(this),t))}:function(t,...r){const n=e.call(j(this),t,...r);return x.set(n,t.sort?t.sort():[t]),O(n)}:(t instanceof IDBTransaction&&function(t){if(w.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{e(),n()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)}));w.set(t,e)}(t),r=t,(m||(m=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>r instanceof t))?new Proxy(t,S):t);var e,r}function O(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{e(O(t.result)),n()},i=()=>{r(t.error),n()};t.addEventListener("success",o),t.addEventListener("error",i)}));return e.then((e=>{e instanceof IDBCursor&&b.set(e,t)})).catch((()=>{})),E.set(e,t),e}(t);if(k.has(t))return k.get(t);const e=_(t);return e!==t&&(k.set(t,e),E.set(e,t)),e}const j=t=>E.get(t);function P(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),c=O(a);return n&&a.addEventListener("upgradeneeded",(t=>{n(O(a.result),t.oldVersion,t.newVersion,O(a.transaction),t)})),r&&a.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),c.then((t=>{i&&t.addEventListener("close",(()=>i())),o&&t.addEventListener("versionchange",(t=>o(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),c}const I=["get","getKey","getAll","getAllKeys","count"],T=["put","add","delete","clear"],A=new Map;function N(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(A.get(e))return A.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=T.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!I.includes(r))return;const i=async function(t,...e){const i=this.transaction(t,o?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(e.shift())),(await Promise.all([a[r](...e),o&&i.done]))[0]};return A.set(e,i),i}function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function D(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||C(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=C(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function C(t,e){if(t){if("string"==typeof t)return G(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(t,e):void 0}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function U(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?M(Object(r),!0).forEach((function(e){R(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function R(t,e,r){return(e=V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==F(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(F(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function q(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function z(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){q(i,n,o,a,c,"next",t)}function c(t){q(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,V(n.key),n)}}function V(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}var H;H=S,S={...H,get:(t,e,r)=>N(t,e)||H.get(t,e,r),has:(t,e)=>!!N(t,e)||H.has(t,e)};const J=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dbName="StoryMapDB",this.version=3,this.db=null},e=[{key:"init",value:(w=z(W().mark((function t(){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(this.dbName,this.version,{upgrade:function(t,e,r,n){if(console.log("Upgrading IDB from version ".concat(e," to ").concat(r)),!t.objectStoreNames.contains("offlineStories")){var o=t.createObjectStore("offlineStories",{keyPath:"id",autoIncrement:!0});o.createIndex("timestamp","timestamp"),o.createIndex("synced","synced")}t.objectStoreNames.contains("favorites")||t.createObjectStore("favorites",{keyPath:"storyId"}).createIndex("timestamp","timestamp"),t.objectStoreNames.contains("settings")||t.createObjectStore("settings",{keyPath:"key"}),t.objectStoreNames.contains("cache")||t.createObjectStore("cache",{keyPath:"key"}).createIndex("timestamp","timestamp")}});case 2:return this.db=t.sent,t.abrupt("return",this.db);case 4:case"end":return t.stop()}}),t,this)}))),function(){return w.apply(this,arguments)})},{key:"saveOfflineStory",value:(b=z(W().mark((function t(e){var r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("offlineStories","readwrite"),o=n.objectStore("offlineStories"),i=U(U({},e),{},{timestamp:(new Date).getTime(),synced:!1,id:e.id||"offline_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}),t.next=8,o.add(i);case 8:return t.abrupt("return",i.id);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return b.apply(this,arguments)})},{key:"getOfflineStories",value:(g=z(W().mark((function t(){var e,r,n;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=t.sent,r=e.transaction("offlineStories","readonly"),n=r.objectStore("offlineStories"),t.abrupt("return",n.getAll());case 6:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)})},{key:"getUnsyncedStories",value:(m=z(W().mark((function t(){var e,r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=t.sent,r=e.transaction("offlineStories","readonly"),n=r.objectStore("offlineStories"),o=n.index("synced"),t.abrupt("return",o.getAll(IDBKeyRange.only(!1)));case 7:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"markStoryAsSynced",value:(y=z(W().mark((function t(e){var r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("offlineStories","readwrite"),o=n.objectStore("offlineStories"),t.next=7,o.get(e);case 7:if(!(i=t.sent)){t.next=13;break}return i.synced=!0,i.syncedAt=(new Date).getTime(),t.next=13,o.put(i);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"deleteOfflineStory",value:(v=z(W().mark((function t(e){var r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("offlineStories","readwrite"),o=n.objectStore("offlineStories"),t.next=7,o.delete(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"addToFavorites",value:(d=z(W().mark((function t(e){var r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("favorites","readwrite"),o=n.objectStore("favorites"),i={storyId:e.id,story:e,timestamp:(new Date).getTime()},t.next=8,o.put(i);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"removeFromFavorites",value:(p=z(W().mark((function t(e){var r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("favorites","readwrite"),o=n.objectStore("favorites"),t.next=7,o.delete(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"getFavorites",value:(h=z(W().mark((function t(){var e,r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=t.sent,r=e.transaction("favorites","readonly"),n=r.objectStore("favorites"),t.next=7,n.getAll();case 7:return o=t.sent,t.abrupt("return",o.map((function(t){return t.story})));case 9:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"isFavorite",value:(f=z(W().mark((function t(e){var r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("favorites","readonly"),o=n.objectStore("favorites"),t.next=7,o.get(e);case 7:return i=t.sent,t.abrupt("return",!!i);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"setCache",value:(l=z(W().mark((function t(e,r){var n,o,i,a,c,s=arguments;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:3e5,t.next=3,this.init();case 3:return o=t.sent,i=o.transaction("cache","readwrite"),a=i.objectStore("cache"),c={key:e,data:r,timestamp:(new Date).getTime(),expires:(new Date).getTime()+n},t.next=9,a.put(c);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"getCache",value:(u=z(W().mark((function t(e){var r,n,o,i;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("cache","readonly"),o=n.objectStore("cache"),t.next=7,o.get(e);case 7:if(!((i=t.sent)&&i.expires>(new Date).getTime())){t.next=10;break}return t.abrupt("return",i.data);case 10:if(!i){t.next=13;break}return t.next=13,this.deleteCache(e);case 13:return t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"deleteCache",value:(s=z(W().mark((function t(e){var r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return r=t.sent,n=r.transaction("cache","readwrite"),o=n.objectStore("cache"),t.next=7,o.delete(e);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"clearExpiredCache",value:(c=z(W().mark((function t(){var e,r,n,o,i,a;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=t.sent,r=e.transaction("cache","readwrite"),n=r.objectStore("cache"),o=n.index("timestamp"),i=(new Date).getTime(),t.next=9,o.openCursor();case 9:a=t.sent;case 10:if(!a){t.next=19;break}if(!(a.value.expires<i)){t.next=14;break}return t.next=14,a.delete();case 14:return t.next=16,a.continue();case 16:a=t.sent,t.next=10;break;case 19:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"setSetting",value:(a=z(W().mark((function t(e,r){var n,o,i,a;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return n=t.sent,o=n.transaction("settings","readwrite"),i=o.objectStore("settings"),a={key:e,value:r,updatedAt:(new Date).getTime()},t.next=8,i.put(a);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"getSetting",value:(i=z(W().mark((function t(e){var r,n,o,i,a,c=arguments;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:null,t.next=3,this.init();case 3:return n=t.sent,o=n.transaction("settings","readonly"),i=o.objectStore("settings"),t.next=8,i.get(e);case 8:return a=t.sent,t.abrupt("return",a?a.value:r);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"exportData",value:(o=z(W().mark((function t(){var e,r,n,o;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return e=t.sent,t.t0=(new Date).toISOString(),t.t1=this.version,t.next=7,this.getOfflineStories();case 7:return t.t2=t.sent,t.next=10,this.getFavorites();case 10:return t.t3=t.sent,t.t4={},r={exportedAt:t.t0,version:t.t1,offlineStories:t.t2,favorites:t.t3,settings:t.t4},n=e.transaction("settings","readonly"),o=n.objectStore("settings"),t.next=17,o.getAll();case 17:return t.sent.forEach((function(t){r.settings[t.key]=t.value})),t.abrupt("return",r);case 20:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"importData",value:(n=z(W().mark((function t(e){var r,n,o,i,a,c,s,u,l,f,h,p,d,v,y,m,g,b;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&e.version===this.version){t.next=2;break}throw new Error("Invalid data format or version mismatch");case 2:return t.next=4,this.init();case 4:if(r=t.sent,!e.offlineStories){t.next=25;break}n=r.transaction("offlineStories","readwrite"),o=n.objectStore("offlineStories"),i=B(e.offlineStories),t.prev=9,i.s();case 11:if((a=i.n()).done){t.next=17;break}return c=a.value,t.next=15,o.put(c);case 15:t.next=11;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(9),i.e(t.t0);case 22:return t.prev=22,i.f(),t.finish(22);case 25:if(!e.favorites){t.next=45;break}s=r.transaction("favorites","readwrite"),u=s.objectStore("favorites"),l=B(e.favorites),t.prev=29,l.s();case 31:if((f=l.n()).done){t.next=37;break}return h=f.value,t.next=35,u.put({storyId:h.id,story:h,timestamp:(new Date).getTime()});case 35:t.next=31;break;case 37:t.next=42;break;case 39:t.prev=39,t.t1=t.catch(29),l.e(t.t1);case 42:return t.prev=42,l.f(),t.finish(42);case 45:if(!e.settings){t.next=56;break}p=r.transaction("settings","readwrite"),d=p.objectStore("settings"),v=0,y=Object.entries(e.settings);case 49:if(!(v<y.length)){t.next=56;break}return m=D(y[v],2),g=m[0],b=m[1],t.next=53,d.put({key:g,value:b,updatedAt:(new Date).getTime()});case 53:v++,t.next=49;break;case 56:case"end":return t.stop()}}),t,this,[[9,19,22,25],[29,39,42,45]])}))),function(t){return n.apply(this,arguments)})},{key:"clearAllData",value:(r=z(W().mark((function t(){var e,r,n,o,i,a;return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:e=t.sent,r=0,n=["offlineStories","favorites","settings","cache"];case 5:if(!(r<n.length)){t.next=14;break}return o=n[r],i=e.transaction(o,"readwrite"),a=i.objectStore(o),t.next=11,a.clear();case 11:r++,t.next=5;break;case 14:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&Y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,c,s,u,l,f,h,p,d,v,y,m,g,b,w}());function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Z(){Z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==K(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(K(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function $(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$(i,n,o,a,c,"next",t)}function c(t){$(i,n,o,a,c,"throw",t)}a(void 0)}))}}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function tt(t){var e=function(t){if("object"!=K(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==K(e)?e:e+""}var et=function(){return e=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stories=[],this.map=null,this.markers=[],this.currentFilter="all",this.favoriteIds=[]},r=[{key:"render",value:(a=Q(Z().mark((function t(){return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container home-page">\n        <h1 class="page-title">Story Map</h1>\n        \n        <div class="controls">\n          <button id="filter-all" class="filter-btn active" data-filter="all">All Stories</button>\n          <button id="filter-recent" class="filter-btn" data-filter="recent">Recent</button>\n        </div>\n\n        <div class="content-layout">\n          <div class="stories-list">\n            <h2>Stories</h2>\n            <div id="stories-container" class="stories-container">\n              <div class="loading">Loading stories...</div>\n            </div>\n          </div>\n\n          <div class="map-container">\n            <h2>Story Locations</h2>\n            <div id="map" class="map"></div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=Q(Z().mark((function t(){return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:return t.next=4,this._loadStories();case 4:return t.next=6,this._initMap();case 6:this._setupEventListeners();case 7:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_loadStories",value:(o=Q(Z().mark((function t(){var e,r;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("stories-container")){t.next=4;break}return console.error("Stories container not found"),t.abrupt("return");case 4:if(t.prev=4,e.innerHTML='<div class="loading">Loading stories...</div>',localStorage.getItem("token")){t.next=10;break}return e.innerHTML='\n          <div class="no-stories">\n            <p>Please login to view stories</p>\n            <a href="#/auth" class="auth-prompt-btn">Login / Register</a>\n          </div>\n        ',t.abrupt("return");case 10:return t.next=12,l.getStories();case 12:return r=t.sent,console.log("Stories Response:",r),this.stories=r.listStories||r.listStory||r.stories||[],t.prev=15,t.next=18,J.getFavorites();case 18:this.favoriteIds=t.sent.map((function(t){return t.id})),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(15),console.warn("Could not load favorites list for comparison",t.t0);case 24:if(0!==this.stories.length){t.next=27;break}return e.innerHTML='<div class="no-stories">No stories found. Be the first to share your story!</div>',t.abrupt("return");case 27:this._renderStoriesList(),this._updateMapMarkers(),this._updateAuthNavigation(),t.next=36;break;case 32:t.prev=32,t.t1=t.catch(4),console.error("Load Stories Error:",t.t1),e&&(t.t1.message.includes("401")?(localStorage.removeItem("token"),localStorage.removeItem("user"),e.innerHTML='\n            <div class="no-stories">\n              <p>Session expired. Please login again.</p>\n              <a href="#/auth" class="auth-prompt-btn">Login</a>\n            </div>\n          '):(v("Error loading stories: "+t.t1.message,"error"),e.innerHTML='<div class="error">Failed to load stories. Please try again later.</div>'));case 36:case"end":return t.stop()}}),t,this,[[4,32],[15,21]])}))),function(){return o.apply(this,arguments)})},{key:"_renderStoriesList",value:function(){var t=this,e=document.getElementById("stories-container");if(e){var r=this._getFilteredStories();e.innerHTML=r.map((function(e){var r=t.favoriteIds.includes(e.id);return'\n        <article class="story-card" data-story-id="'.concat(e.id,'">\n          <img src="').concat(e.photoUrl,'" alt="').concat(e.description,'" class="story-image">\n          <div class="story-content">\n            <h3 class="story-description">').concat(e.description,'</h3>\n            <p class="story-date">').concat(d(e.createdAt),"</p>\n            ").concat(e.lat&&e.lon?'<p class="story-location"> '.concat(e.lat.toFixed(4),", ").concat(e.lon.toFixed(4),"</p>"):'<p class="story-location"> Location not specified</p>','\n          </div>\n          <button \n            class="favorite-btn" \n            title="').concat(r?"Already in favorites":"Add to favorites",'" \n            data-story-id="').concat(e.id,'"\n            ').concat(r?"disabled":"","\n          >\n            ").concat(r?"":"","\n          </button>\n        </article>\n      ")})).join(""),e.querySelectorAll(".story-card").forEach((function(e){e.addEventListener("click",(function(){var r=e.dataset.storyId;t._highlightStoryOnMap(r)}))})),e.querySelectorAll(".favorite-btn:not([disabled])").forEach((function(e){e.addEventListener("click",function(){var e=Q(Z().mark((function e(r){var n,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.stopPropagation(),n=r.target.dataset.storyId,e.prev=2,!(o=t.stories.find((function(t){return t.id===n})))){e.next=12;break}return e.next=7,J.addToFavorites(o);case 7:v("Story added to favorites!","success"),r.target.innerHTML="",r.target.disabled=!0,r.target.title="Already in favorites",t.favoriteIds.push(n);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.error("Failed to add to favorites:",e.t0),v("Failed to add to favorites","error");case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}())}))}}},{key:"_getFilteredStories",value:function(){var t=new Date,e=new Date(t.getTime()-6048e5);return"recent"===this.currentFilter?this.stories.filter((function(t){return new Date(t.createdAt)>e})):this.stories}},{key:"_initMap",value:(n=Q(Z().mark((function t(){var e,r=this;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.getElementById("map")){t.next=4;break}return console.error("Map element not found"),t.abrupt("return");case 4:return document.querySelector('link[href*="leaflet"]')||((e=document.createElement("link")).rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(e)),t.abrupt("return",new Promise((function(t){if("undefined"!=typeof L)return r._initializeLeafletMap(),void t();var e=document.createElement("script");e.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",e.onload=function(){r._initializeLeafletMap(),t()},e.onerror=function(){console.error("Failed to load Leaflet"),t()},document.head.appendChild(e)})));case 6:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"_initializeLeafletMap",value:function(){if(document.getElementById("map")&&"undefined"!=typeof L){delete L.Icon.Default.prototype._getIconUrl,L.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png"}),this.map=L.map("map").setView(t.DEFAULT_MAP_CENTER,t.DEFAULT_MAP_ZOOM);var e={OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors"}),Satellite:L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{attribution:" Google Satellite",subdomains:["mt0","mt1","mt2","mt3"],maxZoom:20})};e.OpenStreetMap.addTo(this.map),L.control.layers(e).addTo(this.map),this._updateMapMarkers()}}},{key:"_updateMapMarkers",value:function(){var t=this;this.map&&"undefined"!=typeof L&&(this.markers.forEach((function(e){return t.map.removeLayer(e)})),this.markers=[],this.stories.filter((function(t){return t.lat&&t.lon})).forEach((function(e){var r=L.marker([e.lat,e.lon]).addTo(t.map).bindPopup('\n          <div class="map-popup">\n            <img src="'.concat(e.photoUrl,'" alt="').concat(e.description,'" style="width: 100px; height: 100px; object-fit: cover;">\n            <h4>').concat(e.description,"</h4>\n            <p>").concat(d(e.createdAt),"</p>\n          </div>\n        "));r.storyId=e.id,t.markers.push(r),r.on("click",(function(){t._highlightStoryInList(e.id)}))})))}},{key:"_highlightStoryOnMap",value:function(t){var e=this;this.map&&this.markers.forEach((function(r){r.storyId===t?(r.openPopup(),e.map.setView(r.getLatLng(),e.map.getZoom()),r.setIcon(L.divIcon({className:"highlighted-marker",html:'<div style="background: red; width: 20px; height: 20px; border-radius: 50%;"></div>',iconSize:[20,20]}))):r.setIcon(L.divIcon({className:"normal-marker",html:'<div style="background: blue; width: 15px; height: 15px; border-radius: 50%;"></div>',iconSize:[15,15]}))}))}},{key:"_highlightStoryInList",value:function(t){var e=document.getElementById("stories-container");e&&e.querySelectorAll(".story-card").forEach((function(e){e.dataset.storyId===t?(e.classList.add("highlighted"),e.scrollIntoView({behavior:"smooth",block:"center"})):e.classList.remove("highlighted")}))}},{key:"_setupEventListeners",value:function(){var t=this;setTimeout((function(){var e=document.querySelectorAll(".filter-btn");0!==e.length&&e.forEach((function(e){e.addEventListener("click",(function(e){document.querySelectorAll(".filter-btn").forEach((function(t){return t.classList.remove("active")})),e.target.classList.add("active"),t.currentFilter=e.target.dataset.filter,t._renderStoriesList()}))}))}),200)}},{key:"_updateAuthNavigation",value:function(){var t=document.getElementById("auth-link");if(t){var e=JSON.parse(localStorage.getItem("user")||"{}");localStorage.getItem("token")?(t.textContent="Logout (".concat(e.name||"User",")"),t.href="#/",t.onclick=function(t){t.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("user"),v("Logged out successfully","success"),window.location.hash="#/"}):(t.textContent="Login",t.href="#/auth",t.onclick=null)}}},{key:"destroy",value:function(){this.map&&(this.map.remove(),this.map=null),this.markers=[]}}],r&&X(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o,i,a}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(){nt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==rt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(rt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ot(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function it(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ot(i,n,o,a,c,"next",t)}function c(t){ot(i,n,o,a,c,"throw",t)}a(void 0)}))}}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ct(n.key),n)}}function ct(t){var e=function(t){if("object"!=rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:e+""}var st=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=it(nt().mark((function t(){return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container about-page">\n        <h1 class="page-title">About Story Map</h1>\n        \n        <div class="about-content">\n          <div class="about-section">\n            <h2>What is Story Map?</h2>\n            <p>\n              Story Map is a web application that allows you to share your stories \n              and experiences with specific locations on the map. Connect your memories \n              with places and explore stories from around the world.\n            </p>\n          </div>\n\n          <div class="about-section">\n            <h2>Features</h2>\n            <ul class="features-list">\n              <li> Share your stories with photos</li>\n              <li> Mark locations on interactive maps</li>\n              <li> Explore stories from other users</li>\n              <li> Responsive design for all devices</li>\n              <li> Accessible to everyone</li>\n            </ul>\n          </div>\n\n          <div class="about-section">\n            <h2>Technology</h2>\n            <p>\n              Built with modern web technologies including:\n            </p>\n            <ul class="tech-list">\n              <li>Single Page Application (SPA) Architecture</li>\n              <li>Leaflet for interactive maps</li>\n              <li>Story API for data management</li>\n              <li>Webpack for module bundling</li>\n              <li>Progressive Web App capabilities</li>\n            </ul>\n          </div>\n\n          <div class="about-section">\n            <h2>How to Use</h2>\n            <ol class="usage-steps">\n              <li>Register or login to your account</li>\n              <li>View stories from other users on the home page</li>\n              <li>Click "Share Story" to add your own story</li>\n              <li>Add a photo and description</li>\n              <li>Click on the map to set your story location</li>\n              <li>Share your story with the community!</li>\n            </ol>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=it(nt().mark((function t(){return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,50)}));case 2:console.log("About page loaded successfully");case 3:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:function(){console.log("About page destroyed")}}],e&&at(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ht(){ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ut(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ut(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function pt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function dt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){pt(i,n,o,a,c,"next",t)}function c(t){pt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t){if("object"!=ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ut(e)?e:e+""}var mt=function(){return e=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.map=null,this.selectedLocation=null,this.photoFile=null,this.cameraStream=null,this.locationMarker=null},r=[{key:"render",value:(c=dt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container add-story-page">\n        <h1 class="page-title">Share Your Story</h1>\n        \n        <form id="add-story-form" class="story-form">\n          <div class="form-group">\n            <label for="story-description">Story Description *</label>\n            <textarea \n              id="story-description" \n              name="description" \n              rows="4" \n              placeholder="Tell us your story..." \n              required\n            ></textarea>\n            <div id="description-error" class="error-message"></div>\n          </div>\n\n          <div class="form-group">\n            <label for="story-photo">Photo *</label>\n            <div class="photo-options">\n              <button type="button" id="upload-photo-btn" class="photo-btn">\n                 Upload Photo\n              </button>\n              <button type="button" id="camera-photo-btn" class="photo-btn">\n                 Take Photo\n              </button>\n            </div>\n            <input \n              type="file" \n              id="story-photo" \n              name="photo" \n              accept="image/*" \n              style="display: none;"\n            />\n            <div id="camera-preview" class="camera-preview" style="display: none;">\n              <video id="camera-video" autoplay playsinline></video>\n              <button type="button" id="capture-btn" class="photo-btn">Capture</button>\n              <canvas id="camera-canvas" style="display: none;"></canvas>\n            </div>\n            <div id="photo-preview" class="photo-preview"></div>\n            <div id="photo-error" class="error-message"></div>\n          </div>\n\n          <div class="form-group">\n            <label>Select Location (Optional)</label>\n            <p class="help-text">Click on the map below to set your story location</p>\n            <div id="location-map" class="location-map"></div>\n            <div id="selected-location" class="selected-location">\n              No location selected\n            </div>\n          </div>\n\n          <div class="form-actions">\n            <button type="submit" class="submit-btn">Share Story</button>\n            <button type="button" id="cancel-btn" class="cancel-btn">Cancel</button>\n          </div>\n        </form>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"afterRender",value:(a=dt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:if(localStorage.getItem("token")){t.next=6;break}return this._showAuthRequired(),t.abrupt("return");case 6:return t.next=8,this._initializeMap();case 8:this._setupEventListeners();case 9:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"_showAuthRequired",value:function(){var t=document.querySelector(".main-content");t&&(t.innerHTML='\n        <section class="container">\n          <div class="no-stories">\n            <h2>Authentication Required</h2>\n            <p>Please login to share your story</p>\n            <a href="#/auth" class="auth-prompt-btn">Login / Register</a>\n          </div>\n        </section>\n      ')}},{key:"_initializeMap",value:(i=dt(ht().mark((function t(){var e,r=this;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.querySelector('link[href*="leaflet"]')||((e=document.createElement("link")).rel="stylesheet",e.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(e)),t.abrupt("return",new Promise((function(t){if("undefined"!=typeof L)return r._setupMap(),void t();var e=document.createElement("script");e.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",e.onload=function(){r._setupMap(),t()},e.onerror=function(e){console.error("Failed to load Leaflet:",e),t()},document.head.appendChild(e)})));case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"_setupMap",value:function(){var e=this;document.getElementById("location-map")?(delete L.Icon.Default.prototype._getIconUrl,L.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png"}),this.map=L.map("location-map").setView(t.DEFAULT_MAP_CENTER,t.DEFAULT_MAP_ZOOM),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors"}).addTo(this.map),this.map.on("click",(function(t){e._selectLocation(t.latlng)}))):console.warn("Map element not found")}},{key:"_selectLocation",value:function(t){this.locationMarker&&this.map.removeLayer(this.locationMarker),this.locationMarker=L.marker(t).addTo(this.map).bindPopup("Story Location").openPopup(),this.selectedLocation=t;var e=document.getElementById("selected-location");e&&(e.textContent="Selected: ".concat(t.lat.toFixed(4),", ").concat(t.lng.toFixed(4)),e.classList.add("has-location"))}},{key:"_setupEventListeners",value:function(){var t=this;setTimeout((function(){t._setupFormEventListeners(),t._setupPhotoEventListeners(),t._setupButtonEventListeners()}),150)}},{key:"_setupFormEventListeners",value:function(){var t=this,e=document.getElementById("add-story-form");e?e.addEventListener("submit",(function(e){e.preventDefault(),t._submitForm()})):console.warn("Form element not found")}},{key:"_setupPhotoEventListeners",value:function(){var t=this,e=document.getElementById("upload-photo-btn"),r=document.getElementById("camera-photo-btn"),n=document.getElementById("story-photo"),o=document.getElementById("capture-btn");e&&e.addEventListener("click",(function(){n&&n.click()})),n&&n.addEventListener("change",(function(e){t._handleFileSelect(e.target.files[0])})),r&&r.addEventListener("click",(function(){t._startCamera()})),o&&o.addEventListener("click",(function(){t._capturePhoto()}))}},{key:"_setupButtonEventListeners",value:function(){var t=document.getElementById("cancel-btn");t&&t.addEventListener("click",(function(){window.location.hash="#/"}))}},{key:"_handleFileSelect",value:function(t){t&&(t.type.startsWith("image/")?(this.photoFile=t,this._displayPhotoPreview(t),this._stopCamera()):v("Please select an image file","error"))}},{key:"_displayPhotoPreview",value:function(t){var e=this,r=document.getElementById("photo-preview");if(r){var n=new FileReader;n.onload=function(t){r.innerHTML='\n        <img src="'.concat(t.target.result,'" alt="Preview" class="photo-preview-image">\n        <button type="button" class="remove-photo-btn">&times;</button>\n      ');var n=r.querySelector(".remove-photo-btn");n&&n.addEventListener("click",(function(){e._removePhoto()}))},n.readAsDataURL(t)}}},{key:"_startCamera",value:(o=dt(ht().mark((function t(){var e,r,n;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});case 3:this.cameraStream=t.sent,e=document.getElementById("camera-video"),r=document.getElementById("camera-preview"),e&&r&&(e.srcObject=this.cameraStream,r.style.display="block",(n=document.querySelector(".photo-options"))&&(n.style.display="none")),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),v("Cannot access camera: "+t.t0.message,"error");case 12:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return o.apply(this,arguments)})},{key:"_capturePhoto",value:function(){var t=this,e=document.getElementById("camera-video"),r=document.getElementById("camera-canvas");if(e&&r){var n=r.getContext("2d");r.width=e.videoWidth,r.height=e.videoHeight,n.drawImage(e,0,0),r.toBlob((function(e){t.photoFile=new File([e],"camera-photo.jpg",{type:"image/jpeg"}),t._displayPhotoPreviewFromCanvas(r),t._stopCamera()}),"image/jpeg")}}},{key:"_displayPhotoPreviewFromCanvas",value:function(t){var e=this,r=document.getElementById("photo-preview");if(r){r.innerHTML='\n      <img src="'.concat(t.toDataURL(),'" alt="Camera capture" class="photo-preview-image">\n      <button type="button" class="remove-photo-btn">&times;</button>\n    ');var n=r.querySelector(".remove-photo-btn");n&&n.addEventListener("click",(function(){e._removePhoto()}))}}},{key:"_stopCamera",value:function(){this.cameraStream&&(this.cameraStream.getTracks().forEach((function(t){return t.stop()})),this.cameraStream=null);var t=document.getElementById("camera-preview");t&&(t.style.display="none");var e=document.querySelector(".photo-options");e&&(e.style.display="flex")}},{key:"_removePhoto",value:function(){this.photoFile=null;var t=document.getElementById("photo-preview");t&&(t.innerHTML="");var e=document.getElementById("story-photo");e&&(e.value="")}},{key:"_submitForm",value:(n=dt(ht().mark((function t(){var e,r,n,o,i,a;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("story-description")){t.next=3;break}return t.abrupt("return");case 3:if(r=e.value,n={description:r,photo:this.photoFile,lat:this.selectedLocation?this.selectedLocation.lat:null,lon:this.selectedLocation?this.selectedLocation.lng:null},(o=y(n)).isValid){t.next=9;break}return Object.entries(o.errors).forEach((function(t){var e=lt(t,2),r=e[0],n=e[1],o=document.getElementById("".concat(r,"-error"));o&&(o.textContent=n)})),t.abrupt("return");case 9:return document.querySelectorAll(".error-message").forEach((function(t){t.textContent=""})),t.prev=10,(i=document.querySelector(".submit-btn"))&&(i.disabled=!0,i.textContent="Sharing..."),t.next=15,l.addStory(n);case 15:v("Story shared successfully!","success"),setTimeout((function(){window.location.hash="#/"}),2e3),t.next=24;break;case 19:t.prev=19,t.t0=t.catch(10),v("Failed to share story: "+t.t0.message,"error"),(a=document.querySelector(".submit-btn"))&&(a.disabled=!1,a.textContent="Share Story");case 24:case"end":return t.stop()}}),t,this,[[10,19]])}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){this._stopCamera(),this.map&&(this.map.remove(),this.map=null)}}],r&&vt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o,i,a,c}();function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function bt(){bt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==gt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(gt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function wt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){wt(i,n,o,a,c,"next",t)}function c(t){wt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function Et(t){var e=function(t){if("object"!=gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(e)?e:e+""}var Lt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isLogin=!0},e=[{key:"render",value:(a=xt(bt().mark((function t(){return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container auth-page">\n        <div class="auth-container">\n          <h1 class="page-title">'.concat(this.isLogin?"Login":"Register",'</h1>\n          \n          \x3c!-- Demo Credentials Info --\x3e\n          <div class="demo-info">\n            <h3>Demo Credentials:</h3>\n            <p><strong>Email:</strong> dicoding@dicoding.com</p>\n            <p><strong>Password:</strong> dicoding</p>\n            <p><small>Or register with new email (password min. 8 characters)</small></p>\n          </div>\n          \n          <form id="auth-form" class="auth-form">\n            ').concat(this.isLogin?"":'\n              <div class="form-group">\n                <label for="name">Name</label>\n                <input type="text" id="name" name="name" required>\n              </div>\n            ','\n            \n            <div class="form-group">\n              <label for="email">Email</label>\n              <input type="email" id="email" name="email" required \n                     value="').concat(this.isLogin?"dicoding@dicoding.com":"",'">\n            </div>\n            \n            <div class="form-group">\n              <label for="password">Password</label>\n              <input type="password" id="password" name="password" required \n                     value="').concat(this.isLogin?"dicoding":"",'">\n              ').concat(this.isLogin?"":'\n                <small class="help-text">Minimum 8 characters</small>\n              ','\n            </div>\n            \n            <div class="form-actions">\n              <button type="submit" class="submit-btn">\n                ').concat(this.isLogin?"Login":"Register","\n              </button>\n              ").concat(this.isLogin?'\n                <button type="button" id="demo-login-btn" class="demo-btn">\n                  Quick Demo Login\n                </button>\n              ':"",'\n            </div>\n            \n            <p class="auth-switch">\n              ').concat(this.isLogin?"Don't have an account? ":"Already have an account? ",'\n              <button type="button" id="switch-auth" class="link-btn">\n                ').concat(this.isLogin?"Register":"Login","\n              </button>\n            </p>\n          </form>\n        </div>\n      </section>\n    "));case 1:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=xt(bt().mark((function t(){return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:this._setupEventListeners(),localStorage.getItem("token")&&(v("Already logged in!","success"),window.location.hash="#/");case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_setupEventListeners",value:function(){var t=this;setTimeout((function(){t._setupFormEvents(),t._setupButtonEvents()}),150)}},{key:"_setupFormEvents",value:function(){var t=this,e=document.getElementById("auth-form");e?e.addEventListener("submit",(function(e){e.preventDefault(),t._handleAuth()})):console.warn("Auth form not found")}},{key:"_setupButtonEvents",value:function(){var t=this,e=document.getElementById("switch-auth"),r=document.getElementById("demo-login-btn");e&&e.addEventListener("click",(function(){t.isLogin=!t.isLogin,t._rerender()})),r&&r.addEventListener("click",(function(){t._handleDemoLogin()}))}},{key:"_handleDemoLogin",value:(o=xt(bt().mark((function t(){var e;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.login({email:"dicoding@dicoding.com",password:"dicoding"});case 3:e=t.sent,localStorage.setItem("token",e.data.token),localStorage.setItem("user",JSON.stringify(e.data.user)),v("Demo login successful!","success"),setTimeout((function(){window.location.hash="#/"}),1e3),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),v("Demo login failed: "+t.t0.message,"error");case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(){return o.apply(this,arguments)})},{key:"_handleAuth",value:(n=xt(bt().mark((function t(){var e,r,n,o,i,a,c,s,u,f,h;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("auth-form")){t.next=3;break}return t.abrupt("return");case 3:if(r=new FormData(e),n=Object.fromEntries(r),t.prev=5,(c=e.querySelector(".submit-btn"))&&(c.disabled=!0,c.textContent=this.isLogin?"Logging in...":"Registering..."),!this.isLogin){t.next=14;break}return t.next=11,l.login({email:n.email,password:n.password});case 11:s=t.sent,t.next=17;break;case 14:return t.next=16,l.register({name:n.name,email:n.email,password:n.password});case 16:s=t.sent;case 17:if(u=(null===(o=s.data)||void 0===o?void 0:o.token)||(null===(i=s.loginResult)||void 0===i?void 0:i.token),f=(null===(a=s.data)||void 0===a?void 0:a.user)||s.loginResult,u){t.next=21;break}throw new Error("No token received from server");case 21:localStorage.setItem("token",u),localStorage.setItem("user",JSON.stringify(f)),v(this.isLogin?"Login successful!":"Registration successful!","success"),setTimeout((function(){window.location.hash="#/"}),1e3),t.next=33;break;case 27:t.prev=27,t.t0=t.catch(5),console.error("Auth Error:",t.t0),v("Error: "+t.t0.message,"error"),(h=document.querySelector(".submit-btn"))&&(h.disabled=!1,h.textContent=this.isLogin?"Login":"Register");case 33:case"end":return t.stop()}}),t,this,[[5,27]])}))),function(){return n.apply(this,arguments)})},{key:"_rerender",value:(r=xt(bt().mark((function t(){var e;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector("#main-content")){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.render();case 5:return e.innerHTML=t.sent,t.next=8,this.afterRender();case 8:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:function(){console.log("Auth page destroyed")}}],e&&kt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function _t(){_t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==St(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(St(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ot(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function jt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ot(i,n,o,a,c,"next",t)}function c(t){Ot(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function It(t){var e=function(t){if("object"!=St(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=St(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==St(e)?e:e+""}const Tt=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.registration=null,this.subscription=null,this.isSubscribed=!1,this.VAPID_PUBLIC_KEY="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"},e=[{key:"init",value:(a=jt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.next=3;break}return console.warn("Push notifications not supported"),t.abrupt("return",!1);case 3:return t.prev=3,t.next=6,navigator.serviceWorker.ready;case 6:return this.registration=t.sent,t.next=9,this._checkSubscription();case 9:return this._updateSubscriptionUI(),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(3),console.error("Error initializing push notifications:",t.t0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,this,[[3,13]])}))),function(){return a.apply(this,arguments)})},{key:"_checkSubscription",value:(i=jt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.registration.pushManager.getSubscription();case 3:this.subscription=t.sent,this.isSubscribed=!(null===this.subscription),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error checking subscription:",t.t0),this.isSubscribed=!1;case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return i.apply(this,arguments)})},{key:"subscribe",value:(o=jt(_t().mark((function t(){var e;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.registration){t.next=2;break}throw new Error("Service Worker not ready");case 2:return t.prev=2,t.next=5,Notification.requestPermission();case 5:if("granted"===t.sent){t.next=8;break}throw new Error("Notification permission denied");case 8:return t.next=10,this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlBase64ToUint8Array(this.VAPID_PUBLIC_KEY)});case 10:return this.subscription=t.sent,console.log("Browser subscription successful:",this.subscription.toJSON()),t.prev=12,t.next=15,l.subscribePush(this.subscription);case 15:if(!(e=t.sent).error){t.next=18;break}throw new Error("API Error: ".concat(e.message));case 18:console.log("Server subscription successful:",e),t.next=28;break;case 21:return t.prev=21,t.t0=t.catch(12),console.error("Failed to send subscription to server:",t.t0),t.next=26,this.subscription.unsubscribe();case 26:throw this.subscription=null,t.t0;case 28:return this.isSubscribed=!0,this._updateSubscriptionUI(),v("Push notifications enabled!","success"),t.abrupt("return",this.subscription);case 34:return t.prev=34,t.t1=t.catch(2),console.error("Failed to subscribe to push notifications:",t.t1),this.isSubscribed=!1,this._updateSubscriptionUI(),v("Failed to enable push: ".concat(t.t1.message),"error"),t.abrupt("return",null);case 41:case"end":return t.stop()}}),t,this,[[2,34],[12,21]])}))),function(){return o.apply(this,arguments)})},{key:"unsubscribe",value:(n=jt(_t().mark((function t(){var e;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.subscription){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.prev=3,t.next=6,l.unsubscribePush(this.subscription);case 6:if(!(e=t.sent).error){t.next=9;break}throw new Error("API Error: ".concat(e.message));case 9:console.log("Server unsubscription successful:",e),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(3),console.error("Failed to send unsubscription to server:",t.t0),v("Failed to update server, but unsubscribed from browser.","warn");case 16:return t.next=18,this.subscription.unsubscribe();case 18:t.sent&&(this.isSubscribed=!1,this.subscription=null,this._updateSubscriptionUI(),v("Push notifications disabled","info"),console.log("User is unsubscribed.")),t.next=26;break;case 22:t.prev=22,t.t1=t.catch(2),console.error("Error unsubscribing from push notifications:",t.t1),v("Failed to disable push notifications","error");case 26:case"end":return t.stop()}}),t,this,[[2,22],[3,12]])}))),function(){return n.apply(this,arguments)})},{key:"toggleSubscription",value:(r=jt(_t().mark((function t(){return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isSubscribed){t.next=5;break}return t.next=3,this.unsubscribe();case 3:t.next=7;break;case 5:return t.next=7,this.subscribe();case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_updateSubscriptionUI",value:function(){var t=document.getElementById("push-toggle-btn"),e=document.getElementById("push-status");t&&(t.textContent=this.isSubscribed?"Disable Push":"Enable Push",t.classList.toggle("active",this.isSubscribed)),e&&(e.textContent=this.isSubscribed?"Enabled":"Disabled",e.className="push-status ".concat(this.isSubscribed?"enabled":"disabled"))}},{key:"_urlBase64ToUint8Array",value:function(t){if(!t)throw new Error("VAPID public key is not set.");for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}}],e&&Pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}());function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Nt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(r),!0).forEach((function(e){Dt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Dt(t,e,r){return(e=Wt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Gt(){Gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==At(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(At(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Mt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Mt(i,n,o,a,c,"next",t)}function c(t){Mt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wt(n.key),n)}}function Wt(t){var e=function(t){if("object"!=At(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}var qt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(a=Ut(Gt().mark((function t(){return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container settings-page">\n        <h1 class="page-title">Settings</h1>\n        \n        <div class="settings-content">\n          <div class="setting-card">\n            <h2> Notifications</h2>\n            <p>Manage your notification preferences</p>\n            \n            <div class="setting-control">\n              <button id="push-toggle-btn" class="toggle-btn">\n                Enable Notifications\n              </button>\n              <span id="push-status" class="push-status disabled">\n                Disabled\n              </span>\n            </div>\n          </div>\n\n          <div class="setting-card">\n            <h2> Network Status</h2>\n            <p>Current connection information</p>\n            \n            <div class="setting-control">\n              <span class="offline-status" id="network-status">Checking...</span>\n            </div>\n            \n            <div class="setting-info">\n              <small id="network-info">Checking network status...</small>\n            </div>\n          </div>\n\n          <div class="setting-card">\n            <h2> Data Management</h2>\n            <p>Manage your local data and storage</p>\n            \n            <div class="setting-control">\n              <button id="clear-cache-btn" class="danger-btn">Clear Cache</button>\n              <button id="clear-data-btn" class="danger-btn">Clear All Data</button>\n            </div>\n            \n            <div class="storage-info">\n              <p><strong>Local Storage:</strong> <span id="local-storage-size">Calculating...</span></p>\n              <p><strong>Service Worker:</strong> <span id="sw-status">Checking...</span></p>\n            </div>\n          </div>\n\n          <div class="setting-card">\n            <h2> App Information</h2>\n            <div class="app-info">\n              <p><strong>Version:</strong> 2.0.0</p>\n              <p><strong>Browser:</strong> <span id="browser-info">Checking...</span></p>\n              <p><strong>PWA Support:</strong> <span id="pwa-support">Checking...</span></p>\n              <p><strong>Last Updated:</strong> '.concat((new Date).toLocaleDateString(),'</p>\n            </div>\n          </div>\n\n          <div class="setting-card">\n            <h2> Developer Tools</h2>\n            <p>Tools for development and debugging</p>\n            \n            <div class="setting-control">\n              <button id="reload-sw-btn" class="secondary-btn">Reload Service Worker</button>\n              <button id="test-notification-btn" class="secondary-btn">Test Notification</button>\n            </div>\n            \n            <div class="setting-control">\n              <button id="export-logs-btn" class="secondary-btn">Export Logs</button>\n              <button id="clear-logs-btn" class="danger-btn">Clear Console</button>\n            </div>\n          </div>\n        </div>\n      </section>\n    '));case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"afterRender",value:(i=Ut(Gt().mark((function t(){var e=this;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("--- SETTINGS DEBUG: afterRender() DIPANGGIL ---"),setTimeout(Ut(Gt().mark((function t(){return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("--- SETTINGS DEBUG: setTimeout(0) BERJALAN ---"),t.prev=1,console.log("DEBUG: Memanggil PushNotificationManager.init()..."),t.next=5,Tt.init();case 5:console.log("DEBUG: PushNotificationManager.init() SELESAI."),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("*** ERROR di PushNotificationManager.init() ***",t.t0);case 11:try{console.log("DEBUG: Memanggil _initializeSettings()..."),e._initializeSettings(),console.log("DEBUG: _initializeSettings() SELESAI.")}catch(t){console.error("*** ERROR di _initializeSettings() ***",t)}try{console.log("DEBUG: Memanggil _setupEventListeners()..."),e._setupEventListeners(),console.log("DEBUG: _setupEventListeners() SELESAI.")}catch(t){console.error("*** ERROR di _setupEventListeners() ***",t)}try{console.log("DEBUG: Memanggil _updateAppInfo()..."),e._updateAppInfo(),console.log("DEBUG: _updateAppInfo() SELESAI.")}catch(t){console.error("*** ERROR di _updateAppInfo() ***",t)}console.log("--- SETTINGS DEBUG: afterRender() SELESAI TOTAL ---");case 15:case"end":return t.stop()}}),t,null,[[1,8]])}))),0);case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"_initializeSettings",value:function(){this._updateNetworkStatus(),this._updateStorageInfo()}},{key:"_updateNetworkStatus",value:function(){var t=this,e=document.getElementById("network-status"),r=document.getElementById("network-info");if(e&&r){var n=navigator.onLine;e.textContent=n?"Online":"Offline",e.className="offline-status ".concat(n?"online":"offline"),r.textContent=n?"You are connected to the internet":"You are currently offline. Some features may be limited.";var o=function(){t._updateNetworkStatus()};window.addEventListener("online",o),window.addEventListener("offline",o)}}},{key:"_updateStorageInfo",value:function(){try{var t=0;for(var e in localStorage)localStorage.hasOwnProperty(e)&&(t+=2*localStorage[e].length);var r=document.getElementById("local-storage-size");r&&(r.textContent=this._formatBytes(t))}catch(t){console.error("Error calculating storage size:",t)}var n=document.getElementById("sw-status");n&&(n.textContent="serviceWorker"in navigator?"Active":"Not Supported")}},{key:"_formatBytes",value:function(t){if(0===t)return"0 Bytes";var e=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,e)).toFixed(2))+" "+["Bytes","KB","MB","GB"][e]}},{key:"_setupEventListeners",value:function(){var t=this;setTimeout((function(){t._setupNotificationToggle(),t._setupDataButtons(),t._setupDeveloperTools()}),200)}},{key:"_setupNotificationToggle",value:function(){var t=document.getElementById("push-toggle-btn");t&&t.addEventListener("click",(function(){Tt.toggleSubscription()}))}},{key:"_setupDataButtons",value:function(){var t=this,e=document.getElementById("clear-cache-btn"),r=document.getElementById("clear-data-btn");e&&e.addEventListener("click",(function(){t._clearCache()})),r&&r.addEventListener("click",(function(){t._clearAllData()}))}},{key:"_setupDeveloperTools",value:function(){var t=this,e=document.getElementById("reload-sw-btn"),r=document.getElementById("test-notification-btn"),n=document.getElementById("export-logs-btn"),o=document.getElementById("clear-logs-btn");e&&e.addEventListener("click",(function(){t._reloadServiceWorker()})),r&&r.addEventListener("click",(function(){t._testNotification()})),n&&n.addEventListener("click",(function(){t._exportLogs()})),o&&o.addEventListener("click",(function(){console.clear(),v("Console cleared","info")}))}},{key:"_clearCache",value:(o=Ut(Gt().mark((function t(){var e;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm("Clear browser cache? This will remove temporary files but keep your data.")){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,!("caches"in window)){t.next=9;break}return t.next=6,caches.keys();case 6:return e=t.sent,t.next=9,Promise.all(e.map((function(t){return caches.delete(t)})));case 9:v("Cache cleared successfully","success"),this._updateStorageInfo(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),console.error("Error clearing cache:",t.t0),v("Failed to clear cache","error");case 17:case"end":return t.stop()}}),t,this,[[2,13]])}))),function(){return o.apply(this,arguments)})},{key:"_clearAllData",value:(n=Ut(Gt().mark((function t(){var e,r,n,o,i;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm(" WARNING: This will clear ALL local data including stories and settings. This action cannot be undone.")){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,localStorage.clear(),!("indexedDB"in window)){t.next=10;break}return t.next=7,indexedDB.databases();case 7:e=t.sent,r=Bt(e);try{for(r.s();!(n=r.n()).done;)o=n.value,indexedDB.deleteDatabase(o.name)}catch(t){r.e(t)}finally{r.f()}case 10:if(!("caches"in window)){t.next=16;break}return t.next=13,caches.keys();case 13:return i=t.sent,t.next=16,Promise.all(i.map((function(t){return caches.delete(t)})));case 16:v("All data cleared successfully","success"),setTimeout((function(){location.reload()}),1500),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(2),console.error("Error clearing all data:",t.t0),v("Failed to clear all data","error");case 24:case"end":return t.stop()}}),t,null,[[2,20]])}))),function(){return n.apply(this,arguments)})},{key:"_reloadServiceWorker",value:(r=Ut(Gt().mark((function t(){var e,r,n,o;return Gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("serviceWorker"in navigator)){t.next=27;break}return t.next=4,navigator.serviceWorker.getRegistrations();case 4:e=t.sent,r=Bt(e),t.prev=6,r.s();case 8:if((n=r.n()).done){t.next=14;break}return o=n.value,t.next=12,o.unregister();case 12:t.next=8;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(6),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:return t.next=24,navigator.serviceWorker.register("sw.bundle.js");case 24:v("Service Worker reloaded","success"),t.next=28;break;case 27:v("Service Worker not supported","error");case 28:t.next=34;break;case 30:t.prev=30,t.t1=t.catch(0),console.error("Error reloading Service Worker:",t.t1),v("Failed to reload Service Worker","error");case 34:case"end":return t.stop()}}),t,null,[[0,30],[6,16,19,22]])}))),function(){return r.apply(this,arguments)})},{key:"_testNotification",value:function(){if("Notification"in window)if("granted"===Notification.permission)try{new Notification("Story Map Test",{body:"This is a test notification from Story Map!",icon:"/favicon.png",tag:"test-notification"}),v("Test notification sent","success")}catch(t){console.error("Error showing test notification:",t),v("Failed to show test notification","error")}else v("Please enable notifications first","error");else v("Notifications not supported","error")}},{key:"_exportLogs",value:function(){try{var t={exportedAt:(new Date).toISOString(),userAgent:navigator.userAgent,platform:navigator.platform,localStorage:Ft({},localStorage),settings:{online:navigator.onLine,notificationPermission:Notification.permission,serviceWorker:"serviceWorker"in navigator}},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="story-map-logs-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),v("Logs exported successfully","success")}catch(t){console.error("Error exporting logs:",t),v("Failed to export logs","error")}}},{key:"_updateAppInfo",value:function(){var t=document.getElementById("browser-info");t&&(t.textContent=navigator.userAgent.split(" ").slice(-2).join(" "));var e=document.getElementById("pwa-support");if(e){var r="serviceWorker"in navigator&&"caches"in window;e.textContent=r?"Supported":"Not Supported"}}},{key:"destroy",value:function(){console.log("Settings page destroyed")}}],e&&Rt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Yt(t){return function(t){if(Array.isArray(t))return Vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Vt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ht(){Ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==zt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(zt(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Jt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Jt(i,n,o,a,c,"next",t)}function c(t){Jt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$t(n.key),n)}}function $t(t){var e=function(t){if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}var Qt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.favorites=[],this.currentFilter="all",this.searchTerm=""},e=[{key:"render",value:(i=Kt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container favorites-page">\n        <h1 class="page-title">Favorite Stories</h1>\n        \n        <div class="favorites-controls">\n          <div class="search-box">\n            <input type="text" id="favorites-search" placeholder="Search favorites..." class="search-input">\n            <button type="button" id="search-btn" class="search-btn"></button>\n          </div>\n          \n          <div class="filter-controls">\n            <button id="filter-all" class="filter-btn active" data-filter="all">All</button>\n            <button id="filter-recent" class="filter-btn" data-filter="recent">Recent</button>\n            <button id="filter-with-location" class="filter-btn" data-filter="with-location">With Location</button>\n          </div>\n          \n          <div class="sort-controls">\n            <select id="sort-select" class="sort-select">\n              <option value="newest">Newest First</option>\n              <option value="oldest">Oldest First</option>\n              <option value="alphabetical">Alphabetical</option>\n            </select>\n          </div>\n        </div>\n\n        <div id="favorites-container" class="favorites-container">\n          <div class="loading">Loading favorites...</div>\n        </div>\n\n        <div id="no-favorites" class="no-favorites" style="display: none;">\n          <div class="empty-state">\n            <h3>No favorites yet</h3>\n            <p>Stories you mark as favorite will appear here</p>\n            <a href="#/" class="browse-btn">Browse Stories</a>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=Kt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loadFavorites();case 2:this._setupEventListeners();case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_loadFavorites",value:(n=Kt(Ht().mark((function t(){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J.getFavorites();case 3:this.favorites=t.sent,this._renderFavorites(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error loading favorites:",t.t0),v("Failed to load favorites","error");case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"_renderFavorites",value:function(){var t=document.getElementById("favorites-container"),e=document.getElementById("no-favorites");if(t&&e){if(0===this.favorites.length)return t.style.display="none",void(e.style.display="block");t.style.display="block",e.style.display="none";var r=this._getFilteredFavorites(),n=this._getSortedFavorites(r);t.innerHTML=n.map((function(t){return'\n      <article class="favorite-card" data-story-id="'.concat(t.id,'">\n        <div class="favorite-header">\n          <h3 class="favorite-description">').concat(t.description,'</h3>\n          <button class="favorite-remove-btn" data-story-id="').concat(t.id,'" title="Remove from favorites">\n            \n          </button>\n        </div>\n        \n        <img src="').concat(t.photoUrl,'" alt="').concat(t.description,'" class="favorite-image">\n        \n        <div class="favorite-details">\n          <p class="favorite-date">').concat(d(t.createdAt),"</p>\n          ").concat(t.lat&&t.lon?'<p class="favorite-location"> '.concat(t.lat.toFixed(4),", ").concat(t.lon.toFixed(4),"</p>"):'<p class="favorite-location"> Location not specified</p>','\n        </div>\n        \n        <div class="favorite-actions">\n          <button class="action-btn view-btn" data-story-id="').concat(t.id,'">View Details</button>\n          ').concat(t.lat&&t.lon?'<button class="action-btn map-btn" data-lat="'.concat(t.lat,'" data-lon="').concat(t.lon,'">Show on Map</button>'):"","\n        </div>\n      </article>\n    ")})).join(""),this._setupFavoriteCardEventListeners()}}},{key:"_getFilteredFavorites",value:function(){var t=this,e=this.favorites;switch(this.searchTerm&&(e=e.filter((function(e){return e.description.toLowerCase().includes(t.searchTerm.toLowerCase())}))),this.currentFilter){case"recent":var r=new Date;r.setDate(r.getDate()-7),e=e.filter((function(t){return new Date(t.createdAt)>r}));break;case"with-location":e=e.filter((function(t){return t.lat&&t.lon}))}return e}},{key:"_getSortedFavorites",value:function(t){var e;switch((null===(e=document.getElementById("sort-select"))||void 0===e?void 0:e.value)||"newest"){case"newest":return Yt(t).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}));case"oldest":return Yt(t).sort((function(t,e){return new Date(t.createdAt)-new Date(e.createdAt)}));case"alphabetical":return Yt(t).sort((function(t,e){return t.description.localeCompare(e.description)}));default:return t}}},{key:"_setupEventListeners",value:function(){var t=this,e=document.getElementById("favorites-search"),r=document.getElementById("search-btn");e&&e.addEventListener("input",(function(e){t.searchTerm=e.target.value,t._renderFavorites()})),r&&r.addEventListener("click",(function(){t._renderFavorites()})),document.querySelectorAll(".filter-btn").forEach((function(e){e.addEventListener("click",(function(e){document.querySelectorAll(".filter-btn").forEach((function(t){return t.classList.remove("active")})),e.target.classList.add("active"),t.currentFilter=e.target.dataset.filter,t._renderFavorites()}))}));var n=document.getElementById("sort-select");n&&n.addEventListener("change",(function(){t._renderFavorites()}))}},{key:"_setupFavoriteCardEventListeners",value:function(){var t=this;document.querySelectorAll(".favorite-remove-btn").forEach((function(e){e.addEventListener("click",function(){var r=Kt(Ht().mark((function r(n){var o;return Ht().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.stopPropagation(),o=e.dataset.storyId,r.next=4,t._removeFromFavorites(o);case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())})),document.querySelectorAll(".view-btn").forEach((function(e){e.addEventListener("click",(function(r){r.stopPropagation();var n=e.dataset.storyId;t._viewStoryDetails(n)}))})),document.querySelectorAll(".map-btn").forEach((function(e){e.addEventListener("click",(function(r){r.stopPropagation();var n=parseFloat(e.dataset.lat),o=parseFloat(e.dataset.lon);t._showOnMap(n,o)}))})),document.querySelectorAll(".favorite-card").forEach((function(e){e.addEventListener("click",(function(){var r=e.dataset.storyId;t._viewStoryDetails(r)}))}))}},{key:"_removeFromFavorites",value:(r=Kt(Ht().mark((function t(e){return Ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,J.removeFromFavorites(e);case 3:this.favorites=this.favorites.filter((function(t){return t.id!==e})),this._renderFavorites(),v("Removed from favorites","success"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error removing from favorites:",t.t0),v("Failed to remove from favorites","error");case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return r.apply(this,arguments)})},{key:"_viewStoryDetails",value:function(t){v("Viewing story ".concat(t),"info")}},{key:"_showOnMap",value:function(t,e){window.location.hash="#/?lat=".concat(t,"&lon=").concat(e,"&zoom=15")}},{key:"destroy",value:function(){}}],e&&Zt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();const Xt={"/":new et,"/about":new st,"/add-story":new mt,"/auth":new Lt,"/settings":new qt,"/favorites":new Qt};function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(){ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==te(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(te(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function re(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ne(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){re(i,n,o,a,c,"next",t)}function c(t){re(i,n,o,a,c,"throw",t)}a(void 0)}))}}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ie(n.key),n)}}function ie(t){var e=function(t){if("object"!=te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==te(e)?e:e+""}function ae(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function ce(t,e){return t.get(ue(t,e))}function se(t,e,r){return t.set(ue(t,e),r),r}function ue(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var le=new WeakMap,fe=new WeakMap,he=new WeakMap,pe=new WeakMap,de=new WeakMap,ve=new WeakMap;const ye=function(){return t=function t(e){var r,n=e.navigationDrawer,o=e.drawerButton,i=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ae(this,le,null),ae(this,fe,null),ae(this,he,null),ae(this,pe,null),ae(this,de,null),ae(this,ve,null),se(le,this,i),se(fe,this,o),se(he,this,n),this._setupDrawer(),(r=document.createElement("a")).href="#main-content",r.className="skip-link",r.textContent="Skip to content",r.style.cssText="\n    position: absolute;\n    top: -40px;\n    left: 6px;\n    background: #000;\n    color: white;\n    padding: 8px;\n    text-decoration: none;\n    z-index: 10000;\n    transition: top 0.3s;\n  ",r.addEventListener("click",(function(t){t.preventDefault();var e=document.querySelector(t.target.getAttribute("href"));e&&(e.setAttribute("tabindex","-1"),e.focus(),setTimeout((function(){return e.removeAttribute("tabindex")}),1e3))})),r.addEventListener("focus",(function(){r.style.top="6px"})),r.addEventListener("blur",(function(){r.style.top="-40px"})),document.body.insertBefore(r,document.body.firstChild)},e=[{key:"_setupDrawer",value:function(){var t=this;ce(fe,this).addEventListener("click",(function(){var e=ce(he,t).classList.contains("open");ce(he,t).classList.toggle("open"),ce(fe,t).setAttribute("aria-expanded",!e)})),document.body.addEventListener("click",(function(e){ce(he,t).contains(e.target)||ce(fe,t).contains(e.target)||(ce(he,t).classList.remove("open"),ce(fe,t).setAttribute("aria-expanded","false")),ce(he,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&(ce(he,t).classList.remove("open"),ce(fe,t).setAttribute("aria-expanded","false"))}))}))}},{key:"_getTransitionDirection",value:function(t,e){var r=["/","/auth","/add-story","/about"],n=r.indexOf(t),o=r.indexOf(e);return n<o?"slide-left":n>o?"slide-right":"fade"}},{key:"_performViewTransition",value:(n=ne(ee().mark((function t(e){var r,n,o=arguments;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.length>1&&void 0!==o[1]?o[1]:"fade",document.startViewTransition){t.next=5;break}return t.next=4,e();case 4:return t.abrupt("return");case 5:return document.documentElement.classList.add(r),n=document.startViewTransition(ne(ee().mark((function t(){return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})))),t.next=9,n.finished;case 9:document.documentElement.classList.remove(r);case 10:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"renderPage",value:(r=ne(ee().mark((function t(){var e,r,n,o=this;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,c=location.hash.replace("#","")||"/",s=void 0,s=c.split("/"),i={resource:s[1]||null,id:s[2]||null},a=void 0,a="",i.resource&&(a=a.concat("/".concat(i.resource))),i.id&&(a=a.concat("/:id")),r=Xt[e=a||"/"]){t.next=7;break}return t.next=6,this._performViewTransition((function(){ce(le,o).innerHTML="<h1>Page Not Found</h1>"}),"fade");case 6:return t.abrupt("return");case 7:return n=this._getTransitionDirection(ce(de,this),e),se(de,this,ce(ve,this)),se(ve,this,e),t.next=12,this._performViewTransition(ne(ee().mark((function t(){return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ce(le,o).classList.add("loading"),!ce(pe,o)||!ce(pe,o).destroy){t.next=10;break}return t.prev=2,t.next=5,ce(pe,o).destroy();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),console.warn("Error during page destroy:",t.t0);case 10:return t.prev=10,t.next=13,r.render();case 13:return ce(le,o).innerHTML=t.sent,se(pe,o,r),t.next=17,new Promise((function(t){return setTimeout(t,100)}));case 17:return t.next=19,r.afterRender();case 19:t.next=25;break;case 21:throw t.prev=21,t.t1=t.catch(10),console.error("Error during page render:",t.t1),t.t1;case 25:ce(le,o).classList.remove("loading");case 26:case"end":return t.stop()}}),t,null,[[2,7],[10,21]])}))),n);case 12:t.next=19;break;case 14:return t.prev=14,t.t0=t.catch(0),console.error("Error rendering page:",t.t0),t.next=19,this._performViewTransition((function(){ce(le,o).innerHTML='\n        <section class="container">\n          <h1>Error Loading Page</h1>\n          <p>There was an error loading the page. Please try again.</p>\n          <button onclick="window.location.hash = \'#/\'">Go to Home</button>\n        </section>\n      '}),"fade");case 19:case"end":return t.stop()}var i,a,c,s}),t,this,[[0,14]])}))),function(){return r.apply(this,arguments)})}],e&&oe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function me(t){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(t)}function ge(){ge=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==me(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(me(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},L(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function be(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function we(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){be(i,n,o,a,c,"next",t)}function c(t){be(i,n,o,a,c,"throw",t)}a(void 0)}))}}"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("sw.bundle.js").then((function(t){console.log("Service Worker registered:",t)})).catch((function(t){console.error("Service Worker registration failed:",t)}))})),document.addEventListener("DOMContentLoaded",we(ge().mark((function t(){var e;return ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new ye({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),t.next=3,e.renderPage();case 3:window.addEventListener("hashchange",we(ge().mark((function t(){return ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)}))))})();